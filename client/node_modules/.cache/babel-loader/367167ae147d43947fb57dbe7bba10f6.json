{"ast":null,"code":"/*\n *  Copyright (c) 2018 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.filterIceServers = filterIceServers;\nvar _utils = require('../utils');\nvar utils = _interopRequireWildcard(_utils);\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  } else {\n    var newObj = {};\n    if (obj != null) {\n      for (var key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];\n      }\n    }\n    newObj.default = obj;\n    return newObj;\n  }\n}\n\n// Edge does not like\n// 1) stun: filtered after 14393 unless ?transport=udp is present\n// 2) turn: that does not have all of turn:host:port?transport=udp\n// 3) turn: with ipv6 addresses\n// 4) turn: occurring muliple times\nfunction filterIceServers(iceServers, edgeVersion) {\n  var hasTurn = false;\n  iceServers = JSON.parse(JSON.stringify(iceServers));\n  return iceServers.filter(function (server) {\n    if (server && (server.urls || server.url)) {\n      var urls = server.urls || server.url;\n      if (server.url && !server.urls) {\n        utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\n      }\n      var isString = typeof urls === 'string';\n      if (isString) {\n        urls = [urls];\n      }\n      urls = urls.filter(function (url) {\n        // filter STUN unconditionally.\n        if (url.indexOf('stun:') === 0) {\n          return false;\n        }\n        var validTurn = url.startsWith('turn') && !url.startsWith('turn:[') && url.includes('transport=udp');\n        if (validTurn && !hasTurn) {\n          hasTurn = true;\n          return true;\n        }\n        return validTurn && !hasTurn;\n      });\n      delete server.url;\n      server.urls = isString ? urls[0] : urls;\n      return !!urls.length;\n    }\n  });\n}","map":{"version":3,"names":["Object","defineProperty","exports","value","filterIceServers","_utils","require","utils","_interopRequireWildcard","obj","__esModule","newObj","key","prototype","hasOwnProperty","call","default","iceServers","edgeVersion","hasTurn","JSON","parse","stringify","filter","server","urls","url","deprecated","isString","indexOf","validTurn","startsWith","includes","length"],"sources":["E:/PFE/client/node_modules/webrtc-adapter/dist/edge/filtericeservers.js"],"sourcesContent":["/*\n *  Copyright (c) 2018 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.filterIceServers = filterIceServers;\n\nvar _utils = require('../utils');\n\nvar utils = _interopRequireWildcard(_utils);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\n// Edge does not like\n// 1) stun: filtered after 14393 unless ?transport=udp is present\n// 2) turn: that does not have all of turn:host:port?transport=udp\n// 3) turn: with ipv6 addresses\n// 4) turn: occurring muliple times\nfunction filterIceServers(iceServers, edgeVersion) {\n  var hasTurn = false;\n  iceServers = JSON.parse(JSON.stringify(iceServers));\n  return iceServers.filter(function (server) {\n    if (server && (server.urls || server.url)) {\n      var urls = server.urls || server.url;\n      if (server.url && !server.urls) {\n        utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\n      }\n      var isString = typeof urls === 'string';\n      if (isString) {\n        urls = [urls];\n      }\n      urls = urls.filter(function (url) {\n        // filter STUN unconditionally.\n        if (url.indexOf('stun:') === 0) {\n          return false;\n        }\n\n        var validTurn = url.startsWith('turn') && !url.startsWith('turn:[') && url.includes('transport=udp');\n        if (validTurn && !hasTurn) {\n          hasTurn = true;\n          return true;\n        }\n        return validTurn && !hasTurn;\n      });\n\n      delete server.url;\n      server.urls = isString ? urls[0] : urls;\n      return !!urls.length;\n    }\n  });\n}\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;;AAEZA,MAAM,CAACC,cAAc,CAACC,OAAO,EAAE,YAAY,EAAE;EAC3CC,KAAK,EAAE;AACT,CAAC,CAAC;AACFD,OAAO,CAACE,gBAAgB,GAAGA,gBAAgB;AAE3C,IAAIC,MAAM,GAAGC,OAAO,CAAC,UAAU,CAAC;AAEhC,IAAIC,KAAK,GAAGC,uBAAuB,CAACH,MAAM,CAAC;AAE3C,SAASG,uBAAuBA,CAACC,GAAG,EAAE;EAAE,IAAIA,GAAG,IAAIA,GAAG,CAACC,UAAU,EAAE;IAAE,OAAOD,GAAG;EAAE,CAAC,MAAM;IAAE,IAAIE,MAAM,GAAG,CAAC,CAAC;IAAE,IAAIF,GAAG,IAAI,IAAI,EAAE;MAAE,KAAK,IAAIG,GAAG,IAAIH,GAAG,EAAE;QAAE,IAAIT,MAAM,CAACa,SAAS,CAACC,cAAc,CAACC,IAAI,CAACN,GAAG,EAAEG,GAAG,CAAC,EAAED,MAAM,CAACC,GAAG,CAAC,GAAGH,GAAG,CAACG,GAAG,CAAC;MAAE;IAAE;IAAED,MAAM,CAACK,OAAO,GAAGP,GAAG;IAAE,OAAOE,MAAM;EAAE;AAAE;;AAE5Q;AACA;AACA;AACA;AACA;AACA,SAASP,gBAAgBA,CAACa,UAAU,EAAEC,WAAW,EAAE;EACjD,IAAIC,OAAO,GAAG,KAAK;EACnBF,UAAU,GAAGG,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,SAAS,CAACL,UAAU,CAAC,CAAC;EACnD,OAAOA,UAAU,CAACM,MAAM,CAAC,UAAUC,MAAM,EAAE;IACzC,IAAIA,MAAM,KAAKA,MAAM,CAACC,IAAI,IAAID,MAAM,CAACE,GAAG,CAAC,EAAE;MACzC,IAAID,IAAI,GAAGD,MAAM,CAACC,IAAI,IAAID,MAAM,CAACE,GAAG;MACpC,IAAIF,MAAM,CAACE,GAAG,IAAI,CAACF,MAAM,CAACC,IAAI,EAAE;QAC9BlB,KAAK,CAACoB,UAAU,CAAC,kBAAkB,EAAE,mBAAmB,CAAC;MAC3D;MACA,IAAIC,QAAQ,GAAG,OAAOH,IAAI,KAAK,QAAQ;MACvC,IAAIG,QAAQ,EAAE;QACZH,IAAI,GAAG,CAACA,IAAI,CAAC;MACf;MACAA,IAAI,GAAGA,IAAI,CAACF,MAAM,CAAC,UAAUG,GAAG,EAAE;QAChC;QACA,IAAIA,GAAG,CAACG,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE;UAC9B,OAAO,KAAK;QACd;QAEA,IAAIC,SAAS,GAAGJ,GAAG,CAACK,UAAU,CAAC,MAAM,CAAC,IAAI,CAACL,GAAG,CAACK,UAAU,CAAC,QAAQ,CAAC,IAAIL,GAAG,CAACM,QAAQ,CAAC,eAAe,CAAC;QACpG,IAAIF,SAAS,IAAI,CAACX,OAAO,EAAE;UACzBA,OAAO,GAAG,IAAI;UACd,OAAO,IAAI;QACb;QACA,OAAOW,SAAS,IAAI,CAACX,OAAO;MAC9B,CAAC,CAAC;MAEF,OAAOK,MAAM,CAACE,GAAG;MACjBF,MAAM,CAACC,IAAI,GAAGG,QAAQ,GAAGH,IAAI,CAAC,CAAC,CAAC,GAAGA,IAAI;MACvC,OAAO,CAAC,CAACA,IAAI,CAACQ,MAAM;IACtB;EACF,CAAC,CAAC;AACJ"},"metadata":{},"sourceType":"script"}